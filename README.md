# anomaly_detection_code

This folder contains the code, results, and plots to the paper 

__Exploring Optimal Transport for Event-Level Anomaly Detection at the Large Hadron Collider__

Authors: Nathaniel Craig, Jessica N. Howard, Hancheng Li

arxiv link: https://arxiv.org/abs/2401.15542

Paper DOI: 

# How to cite
If you use this code, please cite the following DOI as well as the above paper:

Code DOI:

# Environment setup

Please make sure that your Python version is Python 3.9 or newer. 

Please use ```conda``` or ```pip``` to install the following packages before running the notebooks. 
```numpy```,
```scikit-learn```,
```POT```,
```tqdm```,
```matplotlib```,
and ```h5py```. 

# Code Outline

The entire repo is split into four parts. 

*```data```

    This folder contains all the data files on local. However, due to the size of data files, we won't upload the files onto this GitHub folder. 
    The original data files can be found on the ADC2021 website: https://mpp-hep.github.io/ADC2021/. 
    The anomaly augmented background dataset can be generated by running the _AnomalyAugmentData.ipynb_ notebook. 

*```experiments```

    This folder contains all the notebooks that generates the results in paper. The notebooks are further arrange into separate folders in terms of their methods. 

*```functions```

    This folder contains the _centralFunctions.ipynb_ notebook which have all the functions used in the notebooks as well as a notebook for testing of the functions. The dataProcessing folder contains the _AnomalyAugmentData.ipynb_ notebook which generates the augmented background data. 

*```results```

    This folder contains all the JSON and npz files that are used for plotting. 

*```paperPlots```
    
    This folder contains the plots for ROC curves and the notebook to generate the plots. 